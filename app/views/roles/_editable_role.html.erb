<%= form_for editable_role, :html => {:class => 'default-form'} do |f| %>
    <div class="clearfix"></div>
    <%= f.error_messages :header_tag => :h3 %>

    <div class="clearfix"></div>
    <div class="mandate_panel"><span>*</span> <%= t("mandatory_field")%></div>
    <div class="clearfix"></div>
    <fieldset class="no-border">

      <div class="row">
        <div class="medium-3 columns">
          <span class="tool-tip-label">
            <%= f.label :name, t("name"), :class => 'key' %>
          </span>
        </div>
        <div class="medium-8 columns">
          <%= f.text_field :name %>
        </div>
        <div class="medium-1 columns">
          <span class="required">*</span>
        </div>
      </div>

      <div class="row">
        <div class="medium-3 columns">
          <span class="tool-tip-label">
            <%= f.label :description, t("description"), :class => 'key' %>
          </span>
        </div>
        <div class="medium-8 columns">
          <%= f.text_area :description %>
        </div>
        <div class="medium-1 columns"> </div>
      </div>

      <div class="row">
        <div class="medium-3 columns">
          <span class="tool-tip-label">
            <%= f.label :permissions, t("permissions.label"), :class => 'key' %>
          </span>
        </div>
        <div class="medium-8 columns">
          <span class="value value_form">
            <% translated_permissions.each do |group_name, permissions| %>
              <span class="section">
                <span class="title"><%= t("permissions.#{group_name}") %></span>
                <% Hash[*permissions.flatten].values.each do |permission| %>
                    <label><%= f.check_box :permissions, {:id => permission.dehumanize, :name => "role[permissions][]"}, permission, "" %>
                    <%= t("permissions.permission.#{permission}") %></label>
                <% end %>
              </span>
            <% end %>
          </span>
        </div>
        <div class="medium-1 columns">
          <span class="required">*</span>
        </div>
      </div>

      <div class="row">
        <div class="medium-3 columns">
          <span class="tool-tip-label">
            <%= f.label :permitted_form_ids, t("forms.label"), :class => 'key' %>
          </span>
        </div>
        <div class="medium-8 columns">
          <span class="value value_form">
            <% @forms_by_record_type.each do |record_type, forms_list| %>
              <span class="section">
                <span class="title"><%= t("forms.record_types.#{record_type}") %></span>
                <% forms_list.each do |form| %>
                    <label><%= f.check_box :permitted_form_ids, {:id => "role_#{form.unique_id}", :name => "role[permitted_form_ids][]"}, form.unique_id, "" %>
                    <%= form.name %></label>
                <% end %>
              </span>
            <% end %>
          </span>
        </div>
        <div class="medium-1 columns">
        </div>
      </div>

    </fieldset>
<% end %>

<% content_for :record_sub_nav do %>
  <!--TODO: After we got the user object in the session replace the DB query with User object-->
  <%= render_controls(@role) %>
<% end %>