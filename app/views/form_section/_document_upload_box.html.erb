<%
  #TODO: Add loading different types of documents (BIA, BID, Other)
  upload_document = field.name
  update_document = upload_document.sub 'upload', 'update'

  documents = formObject[form_id] || []
  documents = documents.select { |document| document["file_name"].present? && document["attachment_key"].present? }
  record_class_name = formObject.class.name.underscore.downcase
%>
<div class="row">
  <p>
    <%= I18n.t("fields.file_upload_box.document_file_restrictions_message") %>
  </p>
</div>
<% if documents.present? && !formObject.new_record?%>
  <% documents.each do |document| %>
    <div class="row update_document">
      <div class="medium-4 columns">
        <span class="tool-tip-label">
          <%= label_tag I18n.t(document_upload_box.name, :default => document_upload_box.display_name) %>
        </span>
      </div>
      <div class="medium-8 columns">
        <div>
          <span class="document"><%= document["file_name"] %></span>
        </div>
      </div>
      <div class="medium-4 columns">
        <label class="key">Document Description</label>
      </div>
      <div class="medium-8 columns">
        <% attachment_key = document["attachment_key"] %>
        <% document_description = document["document_description"] || "" %>
        <% name = "#{record_class_name}[#{update_document}][#{attachment_key}]" %>
        <% description_field_id = "#{record_class_name}_#{update_document}_#{attachment_key}_document_description"%>
        <%= text_field_tag "#{name}[document_description]", document_description, :id => description_field_id %>
        <div>
          <% checkbox_id = "#{record_class_name}_#{update_document}_#{attachment_key}_delete_document" %>
          <%= check_box_tag("#{name}[delete_document]", true, false, :id => checkbox_id) %>
          <%= label_tag checkbox_id, t("#{record_class_name}.actions.delete_document") %>
        </div>
      </div>
    </div>
  <% end %>
<% end %>
<div id="file_container">
  <div id="file-group" class="document">
    <div class="file">
      <div class="row">
        <div class="medium-4 columns">
          <span class="tool-tip-label">
            <%= label_tag "#{formObject.class.name.underscore.downcase}[#{upload_document}][0][document]", I18n.t("fields.file_upload_box.add_document_label"), :class=>'key inline' %>
          </span>
        </div>
        <div class="medium-8 columns file_upload">
          <%= render "form_section/file_input", name: "#{formObject.class.name.underscore.downcase}[#{upload_document}][0][document]", id: "#{formObject.class.name.underscore.downcase}_#{upload_document}_0_document", help_text: document_upload_box.help_text || ""%>
        </div>
      </div>
      <div class="row">
        <div class="medium-4 columns">
          <span class="tool-tip-label">
            <%= label_tag "#{formObject.class.name.underscore.downcase}[#{upload_document}][0][document_description]", I18n.t("fields.file_upload_box.document_description"), :class=>'key inline' %>
          </span>
        </div>
        <div class="medium-8 columns">
          <%= text_field_tag "#{formObject.class.name.underscore.downcase}[#{upload_document}][0][document_description]", "", :id => "#{formObject.class.name.underscore.downcase}_#{upload_document}_0_document_description" %>
        </div>
      </div>
    </div>
  </div>
  <div id="document_upload_box_file_extension_popup_message" title="PRIMERO" style="display:none">
    <p><%= I18n.t("errors.models.child.document_format") %></p>
    <button type="button" class="ui-button ui-widget ui-state-default ui-corner-all ui-button-text-only" role="button" onclick="$(this).parent().parent().remove();">
    <span class="ui-button-text"><%= I18n.t("cases.ok") %></span>
    </button>
  </div>
  <div id="document_upload_box_file_size_popup_message" title="PRIMERO" style="display:none">
    <p><%= I18n.t("errors.models.child.document_size") %></p>
    <button type="button" class="ui-button ui-widget ui-state-default ui-corner-all ui-button-text-only" role="button" onclick="$(this).parent().parent().remove();">
    <span class="ui-button-text"><%= I18n.t("cases.ok") %></span>
    </button>
  </div>
  <div class="row">
    <div class="large-12 columns">
      <%= link_to I18n.t('fields.file_upload_box.add_new_document_button_text'), '', id: 'add-file-upload-field', class: 'green-button right' %>
    </div>
  </div>
</div>
