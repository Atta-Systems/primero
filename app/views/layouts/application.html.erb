<!DOCTYPE html>

<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
<head>
  <meta http-equiv="content-type" content="text/html;charset=UTF-8"/>
  <title><%= @page_name %></title>
  <link rel="shortcut icon" href="/favicon.ico?v=2"/>
  <%= stylesheet_link_tag "application" %>
  <%= yield :stylesheet %>
  <script>
    window._primero = {
      model_object: "<%= controller.controller_name.singularize %>"
    };
  </script>
  <%= javascript_include_tag "application" %>
  <%= csrf_meta_tag %>
  <%= yield :javascript %>
  <%= javascript_tag do %>
      I18n.defaultLocale = "<%= I18n.default_locale %>";
      I18n.locale = "<%= I18n.locale %>";
      I18n.fallbacks = true;
  <% end %>
</head>
<body class="<%= @body_class %>">
<div class="page_container">
  <div class="row">
    <header>
      <div class="large-12 columns">
        <%= link_to 'Primero', root_path, :class => 'logo left', id: "RapidFTR logo" %>
        <div class="right">
          <%= render :partial => "shared/header_links" %>
        </div>
      </div>
    </header>
  </div>
  <div class="main_bar">
    <div class="row">
    <% if logged_in? %>
      <nav class="large-12 columns">
        <ul>
          <li><%= link_to t("navigation.home"), root_path %></li>
          <% if can? :read, TracingRequest %>
            <li><%= link_to t("navigation.tracing_request"), tracing_requests_path %></li>
          <% end  %>
          <% if can? :read, Child %>
            <li><%= link_to t("navigation.cases"), cases_path %></li>
          <% end  %>
          <% if can? :read, Incident %>
            <li><%= link_to t("navigation.incidents"), incidents_path %></li>
          <% end  %>
          <% if false %>
            <% if current_user_name==nil or can? :manage, FormSection %>
                <li><%= link_to t("navigation.forms"), form_sections_path %></li>
            <% end %>
            <% if can? :read, User or can? :show, Role %>
              <li><%= link_to t("navigation.users"), users_path %></li>
            <% end %>
            <% if can?(:read, Device) or can?(:read, Replication) %>
              <li><%= link_to t("navigation.devices"), devices_path %></li>
            <% end %>
          <% end %>
          <% if can? :read, Report%>
            <li><%= link_to t("navigation.reports"), reports_path %></li>
          <% end %>
          <% if can? :view_and_search, Child %>
            <li>
              <%= form_tag search_children_path, :method => :get, :id => "search_form" do %>
                <div class="search">
                  <%= link_to t("navigation.advanced_search"), new_advanced_search_path %>
                  <%= text_field_tag 'query', params[:query] %>
                  <%= submit_tag t("navigation.go"), :action => "children/search", :method => "get", :onclick => "return RapidFTR.validateSearch();" %>
                </div>
              <% end %>
            </li>
          <% end %>
        </ul>
        <div class="clearB"></div>
      </nav>
    <% end %>
    </div>
  </div>
  <% if flash[:notice].present? %>
      <div class='flash row'>
        <p class='notice large-12'><%= flash[:notice] %></p>
      </div>
  <% end %>
  <% if flash[:error].present? %>
      <div class='flash row'>
        <p class='error large-12'><%= flash[:error] %></p>
      </div>
  <% end %>
  <div class="page_content header_section">
    <div class="row">
      <div class="large-12 columns">
        <%= yield :header_sub_nav %>
      </div>
    </div>
    <div class="row">
      <div class="large-6 columns">
        <%= yield :breadcrumbs %>
      </div>
      <div class="large-6 columns">
        <%= yield :header_message %>
      </div>
    </div>
  </div>
  <hr />
  <div class="page_content">
    <%= yield %>
  </div>
</div>

<!-- idle dialog window markup -->
<div id="dialog" title="<%= t("session.about_to_expire") %>">
  <p> <%= t('messages.logoff_warning_prefix') %> <span id="dialog-countdown"></span> <%= t("messages.logoff_warning_suffix") %></p>

  <p><%= t("messages.logoff_confirmation") %></p>
</div>

<div id="password-prompt-dialog" title="<%= t("encrypt.password_title") %>">
  <div class='flash hide'>
    <p class='error'></p>
  </div>
  <p>
    <label for="password-prompt-field"><%= t("encrypt.password_label") %></label>
    <input type="password" id="password-prompt-field" />
  </p>
</div>

</body>
</html>
